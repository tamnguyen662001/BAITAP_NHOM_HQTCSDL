-- BÀI TẬP NHÓM _ QUẢN LÍ NHÀ HÀNG 13/10/20221
-- TẠO CSDL
CREATE DATABASE BAITAP_NHOM_CAPNHAT

USE BAITAP_NHOM_CAPNHAT

GO
-- TẠO BẢNG KHÁCH HÀNG
CREATE TABLE KHACH_HANG
(
	MKH VARCHAR(5) NOT NULL PRIMARY KEY ,
	TENKH NVARCHAR(50) NOT NULL,
	GIOITINH NVARCHAR(5) NOT NULL,
	DIACHI NVARCHAR(20) NOT NULL,
	SDT VARCHAR (15) NOT NULL,
	TENDN VARCHAR(10) NOT NULL,
	MK VARCHAR(10) NOT NULL
)

GO
-- TẠO BẢNG NHÂN VIÊN
CREATE TABLE NHAN_VIEN
(
	MNV VARCHAR(5) NOT NULL PRIMARY KEY,
	TENNV NVARCHAR(50) NOT NULL,
	DIACHI NVARCHAR(20) NOT NULL,
	GIOITINH NVARCHAR(5) NOT NULL,
	NGAYSINH DATE NOT NULL,
	SDT VARCHAR (15) NOT NULL,
	CHUCVU NVARCHAR(20) NOT NULL,
	TENDN VARCHAR(10) NOT NULL,
	MK VARCHAR(10) NOT NULL
)

 GO
-- TẠO BẢNG CHI TIẾT ĐẶT BÀN
/*CREATE TABLE CHI_TIET_DAT_BAN
(
	MBAN VARCHAR(5) NOT NULL ,
	
	

	CONSTRAINT FK_NV FOREIGN KEY (MNV) REFERENCES NHAN_VIEN(MNV),
	CONSTRAINT FK_KH FOREIGN KEY (MKH) REFERENCES KHACH_HANG(MKH),
	CONSTRAINT PK_DB PRIMARY KEY (MBAN, MNV)
)*/
GO
--TẠO BẢNG HÓA ĐƠN
CREATE TABLE HOA_DON
(
	MHD VARCHAR(5) NOT NULL PRIMARY KEY,
	BAN VARCHAR(5) NOT NULL ,
	MKH VARCHAR(5) NOT NULL ,
	NGAYTAO DATETIME NOT NULL,
	MNV VARCHAR(5) NOT NULL ,
	CONSTRAINT FK_HOADON	FOREIGN KEY (MKH) REFERENCES KHACH_HANG (MKH),
	CONSTRAINT FK_HOADON1	FOREIGN KEY (MNV) REFERENCES NHAN_VIEN (MNV)
)
GO
-- TẠO BẢNG LOẠI SẢN PHẨM
CREATE TABLE LOAI_SAN_PHAM
(	
	MLSP VARCHAR(5) NOT NULL PRIMARY KEY,
	TENLSP NVARCHAR(20) NOT NULL
)



CREATE TABLE CHI_TIET_SAN_PHAM
(
	TENSP NVARCHAR(50) NOT NULL PRIMARY KEY,
	MANL VARCHAR(10) NOT NULL,
	SOLUONG SMALLINT NOT NULL,
	DVT NVARCHAR(15) NOT NULL,
	CONSTRAINT FK_SP_NL	FOREIGN KEY (MANL) REFERENCES NGUYEN_LIEU (MANL)
)

GO
-- TẠO BẢNG SẢN PHẨM
CREATE TABLE SAN_PHAM
(
	MSP VARCHAR (5) NOT NULL PRIMARY KEY,
	TENSP NVARCHAR(50) NOT NULL,
	SOLUONG SMALLINT NOT NULL,
	DONGIA FLOAT NOT NULL,
	DVT NVARCHAR(15) NOT NULL,
	MLSP VARCHAR(5) NOT NULL FOREIGN KEY REFERENCES LOAI_SAN_PHAM(MLSP),
	ANHSP VARCHAR(100) NOT NULL,

	CONSTRAINT FK_CTSP	FOREIGN KEY (TENSP) REFERENCES CHI_TIET_SAN_PHAM (TENSP)
)

GO

-- TẠO BẢNG CHI TIẾT HÓA ĐƠN
CREATE TABLE CHI_TIET_HOA_DON
(
	SOLUONG TINYINT NOT NULL,
	DONGIA FLOAT NOT NULL,
	MHD VARCHAR(5) NOT NULL FOREIGN KEY REFERENCES HOA_DON(MHD),
	MSP VARCHAR (5) NOT NULL FOREIGN KEY REFERENCES SAN_PHAM(MSP),
)

GO
CREATE TABLE NHA_CUNG_CAP
(
	MANCC VARCHAR(10) NOT NULL PRIMARY KEY,
	TENNCC NVARCHAR(50) NOT NULL,
	DIACHI NVARCHAR(20) NOT NULL,
	SDT VARCHAR (15) NOT NULL,
)

GO
CREATE TABLE NGUYEN_LIEU
(
	MANL VARCHAR(10) NOT NULL PRIMARY KEY,
	TENNL NVARCHAR(50) NOT NULL,
	NGAYNHAP DATE NOT NULL,
	DONGIA FLOAT NOT NULL,
	DVT NVARCHAR(15) NOT NULL,
)

GO
CREATE TABLE HOA_DON_NHAP
(
	MHD VARCHAR(5) NOT NULL PRIMARY KEY,
	NGAYTAO DATE NOT NULL,
	TONGTIEN FLOAT NOT NULL,
	MNV VARCHAR(5) NOT NULL ,
	MANCC VARCHAR(10) NOT NULL,
	CONSTRAINT FK_HOADONNHAP	FOREIGN KEY (MNV) REFERENCES NHAN_VIEN (MNV),
	CONSTRAINT FK_HOADONNHAP2	FOREIGN KEY (MANCC) REFERENCES NHA_CUNG_CAP(MANCC),
)

CREATE TABLE CHI_TIET_HOA_DON_NHAP
(
	SOLUONG SMALLINT NOT NULL,
	DONGIA FLOAT NOT NULL,
	MHD VARCHAR(5) NOT NULL FOREIGN KEY REFERENCES HOA_DON_NHAP(MHD),
	MANL VARCHAR(10) NOT NULL FOREIGN KEY REFERENCES NGUYEN_LIEU(MANL),
)



CREATE TABLE CHAM_CONG
(
	MNV VARCHAR(5) NOT NULL,
	Ngay DATE NOT NULL,
	MaCa VARCHAR(2)NOT NULL,
	MaCaDB VARCHAR(2),
	
)
CREATE TABLE CA_THUONG
(
	MaCa VARCHAR(2) PRIMARY KEY,
	LOAICA VARCHAR(10) NOT NULL,
	GIATIEN DECIMAL(10) NOT NULL,
	THOIGIAN SMALLINT NOT NULL

)
CREATE TABLE CA_DBIET
(
	MaCaDB VARCHAR(2) PRIMARY KEY,
	LOAICADB VARCHAR(10) NOT NULL,
	GIATIEN DECIMAL(3,2) NOT NULL,
)


ALTER TABLE CHAM_CONG ADD CONSTRAINT FK_CHAM_CONG	FOREIGN KEY (MNV) REFERENCES NHAN_VIEN (MNV)
ALTER TABLE CHAM_CONG ADD CONSTRAINT FK_CHAM_CONG_CA_THUONG	FOREIGN KEY (MaCa) REFERENCES CA_THUONG (MaCa)
ALTER TABLE CHAM_CONG ADD CONSTRAINT FK_CHAM_CONG_CA_DBIET	FOREIGN KEY (MaCaDB) REFERENCES CA_DBIET (MaCaDB)








--=================================================================================

-- NHẬP DỮ LIỆU BẢNG NHÂN VIÊN
INSERT NHAN_VIEN VALUES('01',N'Trần Văn Hòa',N'123 Hòn Chồng','Nam','1/2/1995','0123456',N'QUẢN LÍ','quanli','quanli')
INSERT NHAN_VIEN VALUES('02',N'Lê Văn Đức',N'12 Phan Trọng Tuệ ','Nam','2/4/2001','0139283',N'Phục vụ','ducle','ducle24')
INSERT NHAN_VIEN VALUES('03',N'Bùi Ngọc Hoa',N'11 Củ Chi ',N'Nữ','12/4/2000','0139999',N'Lễ tân','hoabui','hoabui12')
INSERT NHAN_VIEN VALUES('04',N'Lê Văn Sang',N'05 Phan Trọng Tuệ ','Nam','3/6/2000','0233283',N'Phục vụ','sangle','sangle36')
INSERT NHAN_VIEN VALUES('05',N'Nguyễn Khánh An',N'33 Bắc Sơn',N'Nữ','8/4/2002','0133554',N'Thu ngân','annguyen','annguyen84')

-- NHẬP DỮ LIỆU BẢNG KHÁCH HÀNG
INSERT KHACH_HANG VALUES ('KH1',N'Đinh Gia Khánh',N'Nam',N'13/23 Bắc Sơn','0331234','khanhdinh','khanh123')
INSERT KHACH_HANG VALUES ('KH2',N'Nguyễn Trân Anh',N'Nữ',N'233 Điện Biên Phủ','0331122','trananh ','trananh22 ')
INSERT KHACH_HANG VALUES ('KH3',N'Nguyễn Khánh Duy',N'Nam',N'25 Nguyễn Đình Chiểu','0333342','khanhduy','duy3342')
INSERT KHACH_HANG VALUES ('KH4',N'Phan Thị Huyền Trâm',N'Nữ',N'80/23 Bắc Sơn','0338877','tramphan','tramphan77')
INSERT KHACH_HANG VALUES ('KH5',N'Đinh Văn Bảo',N'Nam',N'02 Nguyễn Đình Chiểu','0334343','baodinh','bao4343')


-- NHẬP DỮ LIỆU BẢNG NHÀ CUNG CẤP
INSERT NHA_CUNG_CAP VALUES ('NCC1',N'Hải sản Khánh Duy',N'Vĩnh Hải','0221212')
INSERT NHA_CUNG_CAP VALUES ('NCC2',N'Trại gà Minh Trí',N'Vạn Giã','02233222')
INSERT NHA_CUNG_CAP VALUES ('NCC3',N'Thịt bò Quốc Châu',N'Vĩnh Trường','0224532')
INSERT NHA_CUNG_CAP VALUES ('NCC4',N'Rau sạch Huyền Trâm',N'Đà Lạt','02277666')
INSERT NHA_CUNG_CAP VALUES ('NCC5',N'Giải Khát Tuấn Kiệt',N'Vĩnh Thọ','0221999')

-- NHẬP DỮ LIỆU BẢNG LOẠI SẢN PHẢM

INSERT LOAI_SAN_PHAM VALUES ('HS01',N'Tôm hùm')
INSERT LOAI_SAN_PHAM VALUES ('TH02',N'Gà')
INSERT LOAI_SAN_PHAM VALUES ('GK03',N'Bia')
INSERT LOAI_SAN_PHAM VALUES ('RA04',N'Salat')


/*-- NHẬP DỮ LIỆU BẢNG SẢN PHẢM
INSERT SAN_PHAM VALUES ('HS011', N'Tôm hùm cháy tỏi', 50,350000, N'Phần', 'HS01','#')
INSERT SAN_PHAM VALUES ('TH021', N'Cánh gà chiên mắm', 100,20000, N'Cánh', 'TH02','#')
INSERT SAN_PHAM VALUES ('RA041', N'Rau xào', 120,20000, N'Phần', 'RA04','#')
INSERT SAN_PHAM VALUES ('HS012', N'Tôm hùm nướng bơ', 70,300000, N'Phần', 'HS01','#')
INSERT SAN_PHAM VALUES ('GK031', N'Tiger', 200,350000, N'Thùng', 'GK03','#')
*/

-- NHẤP DỮU LIỆU CÁC BẢNG CHÁM CÔNG
INSERT CA_THUONG VALUES('K1','SANG',10000,6)
INSERT CA_THUONG VALUES('K2','TRUA',11000,6)
INSERT CA_THUONG VALUES('K3','TOI',12000,5)

INSERT CA_DBIET VALUES('L','LE',1.5)
INSERT CA_DBIET VALUES('NN','NGAY NGHI',1.2)
INSERT CA_DBIET VALUES('BT','NG_BTHUONG',1.0)

INSERT CHAM_CONG VALUES('02','1-1-2021','K2','L')
INSERT CHAM_CONG VALUES('02','1-1-2021','K3','NN')
INSERT CHAM_CONG VALUES('02','1-1-2021','K1','NN')
INSERT CHAM_CONG VALUES('02','5-5-2021','K3','L')
INSERT CHAM_CONG VALUES('01','1-1-2021','K2','BT')
INSERT CHAM_CONG VALUES('01','2-1-2021','K1','BT')
INSERT CHAM_CONG VALUES('01','1-2-2021','K3','BT')
INSERT CHAM_CONG VALUES('03','2-1-2021','K1','BT')
INSERT CHAM_CONG VALUES('03','2-2-2021','K2','BT')
INSERT CHAM_CONG VALUES('04','2-3-2021','K2','L')
INSERT CHAM_CONG VALUES('05','2-3-2021','K3','L')
INSERT CHAM_CONG VALUES('05','2-3-2021','K1','BT')


-- NHẤP DỮU LIỆU CÁC BẢNG NGUYÊN LIỆU
INSERT NGUYEN_LIEU VALUES('NL01',N'Thịt','11/12/2021',70000,N'KG')
INSERT NGUYEN_LIEU VALUES('NL02',N'Cá','10/02/2021',50000,N'KG')
INSERT NGUYEN_LIEU VALUES('NL03',N'Vịt','01/12/2021',80000,N'kilogram')
INSERT NGUYEN_LIEU VALUES('NL04',N'Gà','05/02/2021',10000,N'kilogram')
INSERT NGUYEN_LIEU VALUES('NL05',N'Tôm','07/12/2021',12000,N'kilogram')


-- NHẤP DỮU LIỆU CÁC BẢNG CHI TIÉT SẢN PHẨM

-- NHẤP DỮU LIỆU CÁC BẢNG CHI TIẾT HOÁ DƠN (BÁN)

-- NHẤP DỮU LIỆU CÁC BẢNG HOÁ ĐƠN 

-- NHẤP DỮU LIỆU CÁC BẢNG SẢN PHẨM

-- NHẤP DỮU LIỆU CÁC BẢNG CHI TIẾT HD NHẬP

-- NHẤP DỮU LIỆU CÁC BẢNG HOÁ ĐƠN NHẬP




